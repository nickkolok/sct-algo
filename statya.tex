\documentclass{article}


\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[tbtags]{amsmath}
\usepackage{amsfonts,amssymb}

\hoffset -10mm
\voffset -7mm


\usepackage{mathrsfs}
\usepackage{graphicx}

\usepackage{float} % Иначе ругается на таблицу

\usepackage{amssymb,amsmath,amsthm,amsfonts}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Theorem}



\begin{document}


Обозначим через $\mathbb{N}$ множество натуральных чисел, через $\mathbb{Z}$ --- множество целых чисел, через $\mathbb{R}$ --- множество действительных чисел, через $[x]$ --- наименьшее целое число, не превосходящее $x$, через $|A,B|$ --- расстояние между точками $A$ и $B$.
Для заданного $n\in \mathbb{N}, n\geq 3$ обозначим через $C_n$ множество таких последовательностей $M_1,M_2,...,M_n \in \mathbb{R}^2$, что $|M_i,M_j|\in\mathbb{N}$ для всех $1\leq i < j  \leq n$ и  $M_1,M_2,...,M_n$ не принадлежат никакой прямой.
Положим
$$
F(n)=\min\limits_{A\in C_n} d(A),
$$
где $d(A)$ --- диаметр $A$, т. е.
$$
d(A)=\max\limits_{x,y\in A}|x,y|
$$

В настоящей статье представлен алгоритм отыскания таких $A \in C_n$, что $d(A) = F(n)$.






Рассмотрим сначала более общую задачу: для заданного $m \in \mathbb{N}$ отыщем (с точностью до движения) все такие множества $A \in C_n$, что $d(A) = m$.

Предположим, что такое множество найдено и его диаметр достигается на точках $P_1$ и $P_2$.
Введём на плоскости прямоугольную декартову систему координат так, что $P_1 = \left(-\frac{m}{2}; 0 \right)$, $P_2 = \left(\frac{m}{2}; 0\right)$.
Сведём задачу к конечному перебору, показав, что $A \subset P$, где $P$ --- конечное множество.
Действительно, пусть $P_{j} \in A$.
Тогда $|P_{j} P_1| \leq m$, $|P_{j} P_2| \leq m$, $|P_{j} P_1| \in \mathbb{Z}$ и $|P_{j} P_1| \in \mathbb{Z}$.
В качестве $P$ возьмём множество всех точек, удовлетворяющих вышеуказанному условию, т. е. множество точек пересечения пар всевозможных окружностей целого радиуса, не превосходящего $m$, с центрами в $P_1$ и $P_2$ соответственно.

Координаты любой точки из $P$ могут быть выражены через радикалы:
$$
	P = \left\{
		\left(\left.  \frac{a^2-b^2}{2m} ; \sqrt{ \frac{1}{4} \left(m+\frac{a^2-b^2}{m} \right) - a^2 }  \right)	\right| 0 \leq a, b \leq m \cap a+b \geq m
	\right\}
$$
Множества $Q$, $R$ и $S$ содержат $m-1$, $2\left\lbrack\frac{m+1}{2}\right\rbrack$ и $m^2$ точек соответственно.


Для оптимизации перебора сформируем три непересекающихся подмножества (класса?) в множестве $P$:
$Q = \{P_j \in P | P_j = (x_j, 0)\}$;
$R = \{P_j \in P | P_j = (0, x_j), x_j \neq 0\}$;
$S = P \setminus \left( Q \cup R\right)$,
т. е. в множество $S$ попадают точки, у которых ни одна из координат не равна нулю.

Построим теперь граф $G$, вершины которого --- точки $P$;
вершины являются смежными, если расстояние между ними есть целое число, не превосходящее $m$.

На данном этапе задачу нельзя свести к задаче о клике, решение которой описано, например, в [\cite{BronKerbosh}]:
клика может оказаться подмножеством множества $Q$, а значит, и оси абсцисс, что не удовлетворяет условию задачи.

С целью оптимизации дальнейшего перебора будем исключать вершины $P_j$ из графа по следующим правилам до тех пор, пока это возможно:

а) Если $P_j \in Q$ и $P_j$ не соединена ребром ни с какой точкой из $S \cup R$, то $P_j$ можно исключить, и вместе с ней можно исключить точку, симметричную $P_j$ относительно начала координат.

б) Если $P_j \in P$ и $P_j$ имеет менее $n-1$ смежных вершин, то $P_j$ можно исключить вместе с одной (в случае, когда $P_j \in Q \cup R$) или даже тремя (в случае, когда $P_j \in S$) точками, симметричными $P_j$ относительно осей координат.

Использование симметрии позволяет не проводить подсчёт смежных вершин для некоторых точек, что немаловажно для ускорения работы алгоритма на ЭВМ.
Заметим, что при реализации алгоритма симметричные точки целесообразно хранить парами или группами по 4.

Сложность каждой проверки правила (а) для множества $Q$ составляет $O(m^3)$, правила (б) для всего множества $P$ --- $O(m^4)$.


После того, как дальнейшее сокращение графа $G_k$, полученного из графа $G$ применением этих правил $k$ раз, станет невозможным, начнём применять следующее рекуррентное правило, фактически обобщающее правила (а) и (б):

в)
Зафиксируем вершину $P_j$, имеющую минимальное количество смежных вершин.
Через $\varphi(P_j,G_k)$ обозначим подграф графа $G_k$, состоящий из вершины $P_j$ и всех вершин, смежных с ней.

Наличие искомого подграфа графа $G_k$ эквивалентно наличию искомого подграфа либо в $\varphi(P_j,G_k)$, либо в $G_k \setminus P_j$.

Очевидно, что рекурсия заканчивается либо в случае, когда подграф полностью лежит в множестве $Q$, либо в случае, когда количество вершин полученного подграфа не превосходит количества вершин искомого.


! На самом деле тут ещё используется модифицированный алгоритм Брона-Кербоша [\cite{BronKerbosh}].



Отыщем теперь с помощью приведённого алгоритма $F(n)$ для произвольного $n \in \mathbb{N}$.

Очевидно, что $F(3) = 1$.
Положим $m_1=1$, $n_1=3$.
На $k$-м шаге будем искать $A \in C_{n_k}$, такое, что $d(A) = m_k$.
Если такое множество найдено, это означает, что $F(n_k)=m_k$,
в таком случае увеличим количество точек, т. е. положим $n_{k+1} = n_k +1$, $m_{k+1} = m_k$;
в противном случае увеличим диаметр, т. е. $n_{k+1} = n_k$, $m_{k+1} = m_k +1$.



Автору удалось создать программу для ЭВМ и провести расчёты для множеств, диаметр которых не превышает 963.
Результаты вычислений представлены в таблице 1 (через $F_{min}$ и $F_{max}$ обозначены аналитические ограничения, полученные в статье [не знаю, как сослаться]).
Прочерком обозначены ограничения, которые аналитически не получены.

! Непонятно, откуда брать константу $b$ из неравенств Чебышева. Это 1.10555 ?


\begin{table}[H]
\caption{Значения $F(n)$}
\label{tabular:pc_counted}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
\textbf{n}    &  3 & 4 & 5 & 6 &  7 &  8 &  9 & 10 & 11 & 12 & 13 \\
\hline
\textbf{F\textsubscript{min}(n)} &  --- & --- & --- & --- & --- & --- & --- & --- & --- & --- & ---  \\
\hline
\textbf{F(n)} &  1 & 4 & 7 & 8 & 17 & 21 & 29 & 40 & 51 & 63 & 74  \\
\hline
\textbf{F\textsubscript{max}(n)} &  --- & ... & ... & ... & ... & ... & ... & ... & ... & ... & ...  \\
\hline
\hline
\textbf{n}    &  14 &  15 &  16 &  17 &  18 &  19 &  20 &  21 &  22 &  23 &  24 \\
\hline
\textbf{F(n)} &  91 & 104 & 121 & 134 & 153 & 164 & 196 & 212 & 234 & 256 & 286  \\
\hline
\hline
\textbf{n}    &  25 &  26 &  27 &  28 &  29 &  30 &  31 &  32 &  33 &  34 &  35 \\
\hline
\textbf{F(n)} & 304 & 338 & 370 & 384 & 414 & 448 & 464 & 494 & 524 & 553 & 578  \\
\hline
\end{tabular}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
\hline
\textbf{n}    &  36 &  37 &  38 &  39 &  40 &  41 &  42 &  43 & 44 \\

\hline
\textbf{F(n)} & 608 & 642 & 667 & 692 & 754 & 816 & 897 & 959 & >963 \\
\hline
\end{tabular}
\end{center}
\end{table}


Исходный код программы для ЭВМ, с помощью которой производились расчёты, размещён по адресам (гитхаб) и (сайт матфака) на условиях лицензии GNU GPLv3. 


При проведении расчётов на ЭВМ, поддерживающих параллельные вычисления (например, лабораторных ЭВМ, имеющих многоядерный процессор) наиболее целесообразным представляется поиск систем с бОльшим диаметром <<заранее>>.

Пусть имеется возможность исполнять $q$ параллельных процессов.
Всякий раз, когда количество выполняющихся процессов меньше максимально допустимого (т. е. после того, как предыдущий процесс завершил свою работу, либо перед началом вычислений), определим мощность и диаметр множества, которое будет искать запускаемый процесс, применяя следующие три правила до тех пор, пока это возможно:

(i)
Изначально положим $m_1=1$, $n_1=3$.

(ii)
Если множество с диаметром $m_k$ мощности $n_k$ было найдено ранее, положим $n_{k+1} = n_k +1$, $m_{k+1} = m_k$.

(iii)
Если ранее было установлено, что искомого множества с диаметром $m_k$ мощности, не превосходящей $n_k$, не существует,
или если в данный момент выполняется процесс, отыскивающий такое множество, положим $n_{k+1} = n_k +1$, $m_{k+1} = m_k$.

Как только достигнуто такое $k$, что данные правила применить нельзя, следует запустить процесс, отыскивающий множество с диаметром $m_k$ мощности $n_k$.





Стоит ли тут сказать:
б) О времени вычислений? - не ранее, чем выяснится, дают ли кластер.
в) Привести (из прошлой статьи) примеры найденных СЦТ?



Автор выражает благодарность проф. Е. М. Семёнову за ценные советы и плодотворное обсуждение.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage

\addcontentsline{toc}{chapter}{\bibname}
\begin{thebibliography}{99}

\bibitem{BronKerbosh} Bron C., Kerbosh J. (1973), Algorithm 457 — Finding all cliques of an undirected graph, Comm. of ACM, 16, p. 575—577.

\bibitem{Tomita} Etsuji Tomita, Akira Tanaka, Haruhisa Takahashi (2006), The worst-case time complexity for generating all maximal cliques and computational experiments, Theoretical Computer Science, Vol 363, Issue 1, ISSN:0304-3975, p. 28-42.

\end{thebibliography}









%Замечание
%\begin{remark} Отметим, что доказательство теоремы \ref{theo1} 
%может быть распространено на случай ...
%\end{remark}

%Определение
%\begin{definit} Будем называть ...
%\end{definit}

%Предложение
%\begin{propos} Пусть выполняются следующие неравенства...
%\end{propos}

%\begin{figure}[ht]
%\centering
%\includegraphics{1kriv80}
%\caption{Многообразие точек смены кратности.}
%\end{figure}


%===============Список литературы==================



\end{document}
